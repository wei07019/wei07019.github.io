<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<link rel="stylesheet" href="css/style.css" />
		<script src="js/jquery-2.1.0.js"></script>
		<title>会员注册</title>
	</head>
	<body>
		<div id="yyw_top">
			<a class="yyw_setting yyw_left" href="index.html"></a>
			会员注册
		</div>
		<div id="yyw_regname" class="yyw_input">			
			<i class="icon"></i>
			<span>用户名</span>
			<input type="text" placeholder="请输入手机号"/>
			<div class="border"></div>
		</div>
		<div id="yyw_regpsd" class="yyw_input">			
			<i class="icon"></i>
			<span>密码</span>
			<input type="password" placeholder="请输入密码"/>
			<div class="border"></div>
		</div>
		<div id="yyw_ispassword" class="yyw_input">			
			<i class="icon"></i>
			<span>确认密码</span>
			<input type="password" placeholder="请输入密码"/>
			<div class="border"></div>
		</div>
		<p id="yyw_fwtk">同意服务条款</p>
		<button id="register_btn" disabled>注册</button> 
		<p id="reg_err"></p>
	</body>
	<script>
		$(function() {
			var isfw = false;
			var regname;
			var regpsd;
			var ispsd;
			$("#yyw_fwtk").click(function() {
				if(isfw) {
					$(this).removeClass("yyw_fwtk");
					$("#register_btn").css("backgroundColor","#ccc");
					$("#register_btn").prop("disabled",true);
					isfw = false;
				} else {
					$(this).addClass("yyw_fwtk");
					$("#register_btn").css("backgroundColor","#489925");
					$("#register_btn").prop("disabled",false);
					isfw = true;					
				}
			});
			$("#register_btn").click(function(event) {
				
				regname = $("#yyw_regname input").val();
				regpsd = $("#yyw_regpsd input").val();
				ispsd = $("#yyw_ispassword input").val();
				if(/\d{8,11}/.test(regname)) {
					if(regpsd == ispsd) {
						$.ajax({
							url: "http://datainfo.duapp.com/shopdata/userinfo.php",
							data: {status:"register",userID:"regname",password:regpsd},
							dataType: "json",
							success: function(data) {
								if(data == 0) {
									$("#reg_err").html("用户名已注册");
									reg_err();
								} else if(data == 2){
									$("#reg_err").html("数据库错误");
									reg_err();
								} else{
									$("#reg_err").html("登录成功,请登录");
									reg_err();
									setTimeout(function() {
										window.location.href = "login.html";
									},1000)									
								}
							}
						});
					} else {
						$("#reg_err").html("两次密码不相同");
						reg_err();
					}
				} else {
					$("#reg_err").html("手机号码不合法");
					reg_err();
				}
				event.stopPropagation();
			})
			function reg_err() {
				$("#reg_err").fadeIn(100,function() {
					setTimeout(function() {
						$("#reg_err").fadeOut(300);
					},1000)
				});				
			}
		})
	</script>
</html>
